import MySQLdb
import matplotlib.pyplot as plt
from collections import Counter

conn = MySQLdb.connect(host = "localhost", user = "root", passwd = "dealer1073.", db = "aetos", port = 3306, charset = "utf8")
cur = conn.cursor(cursorclass = MySQLdb.cursors.DictCursor)

cur.execute("select * from orders where Symbol = 'gbpusd' and Type = 'Buy'")


#symbol_name = raw_input('Please Enter the Symbol Name:\t')
#order_type = raw_input('Please Enter the Order Type:\t')
#cur.execute("select * from orders where Symbol = '%s' and Type = '%s'" % (symbol_name,order_type))

lines = cur.fetchmany(100)

op_t,vol_t = ([] for i in range(2))
for line in lines:
    op_t.append(line['OpenPrice'])
    vol_t.append(line['Volume'])

#op_1,vol_1,bs_1 = [i.encode('utf') for i in op,vol,bs]

op = [float(i.encode('utf')) for i in op_t]
vol = [float(i.encode('utf')) for i in vol_t]
infor = zip(op,vol)

print type(infor)

'''
unique_price = []

for item,count in Counter(op).most_common():
    if count ==1:
        unique_price.append(item)

duplicate_price = list(set(op) - set(unique_price))

print unique_price
print duplicate_price
print len(unique_price),len(duplicate_price),len(op)




price_dis = {}




for i in range(len(op)):
    if op[i] not in duplicate_price:
        price_dis.update({op[i]:vol[i]})
    else:
        peice_dis.update({op[i]})

'''

cur.close()
conn.close()
